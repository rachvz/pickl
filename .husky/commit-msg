#!/bin/sh

# Conventional Commits validation
# Format: <type>(<scope>): <subject>
# Types: feat, fix, docs, style, refactor, test, chore, build, ci, perf, revert

commit_msg_file=$1
commit_msg=$(cat "$commit_msg_file")

# Regex for conventional commit format
conventional_commit_regex='^(feat|fix|docs|style|refactor|test|chore|build|ci|perf|revert|merge)(\(.+\))?: .{5,72}'

if ! echo "$commit_msg" | grep -qE "$conventional_commit_regex"; then
  echo "‚ùå Invalid commit message format!"
  echo ""
  echo "üìù Commit messages must follow Conventional Commits format:"
  echo "   <type>(<scope>): <subject>"
  echo ""
  echo "Types: feat, fix, docs, style, refactor, test, chore, build, ci, perf, revert, merge"
  echo ""
  echo "Examples:"
  echo "   feat(login): add remember me checkbox"
  echo "   fix(api): resolve timeout issue"
  echo "   docs(readme): update installation steps"
  echo "   test(login): add negative test cases"
  echo ""
  echo "üìö See: https://www.conventionalcommits.org"
  exit 1
fi
